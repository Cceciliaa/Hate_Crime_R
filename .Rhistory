geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate crimes v.s. Non-citizen rate & GINI index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_bw() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.2, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=10, color = "salmon", face="bold")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate crimes v.s. Non-citizen rate & GINI index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_bw() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.4, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=10, color = "salmon", face="bold")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate crimes v.s. Non-citizen rate & GINI index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_bw() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=10, color = "salmon", face="bold")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate crimes v.s. Non-citizen rate & GINI index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=10, color = "salmon", face="bold")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate crimes v.s. Non-citizen rate & GINI index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=10, color = "salmon", face="bold")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate crimes v.s. Non-citizen rate & GINI index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=10, color = "salmon", face="bold")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=10, color = "salmon", face="bold")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon", face="bold")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13, color = "salmon"),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
axis.title = element_text(colour = "salmon"),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.2, 0)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
axis.title = element_text(colour = "salmon"),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.2, 0.2)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
axis.title = element_text(colour = "salmon"),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0.1)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
axis.title = element_text(colour = "salmon"),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
plot_data <- all_data %>%
arrange(-avr_hc) %>%
select(NAME,GINIidx,pct_nonctz,avr_hc) %>%
mutate(hc_level = fct_recode(
factor(ntile(avr_hc, 5)),
`>= 3.5` = "5",
`2.5 ~ 3.5` = "4",
`1.5 ~ 2.5` = "3",
`0.5 ~ 1.5` = "2",
`<= 0.5` = "1"
)) %>%
st_drop_geometry() %>%
na.omit()
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0.1)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
axis.title = element_text(colour = "salmon"),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
yearly_agg <-
read_xls("2008.xls") %>%
summarize(`2008` = sum(Total_icd) / sum(Total_pop) * 100000)
k <- 2
for (i in c(2009:2017)) {
agg_each <- read_xls(paste(as.character(i), ".xls", sep="")) %>%
summarize(total = sum(Total_icd) / sum(Total_pop) * 100000)
yearly_agg <- yearly_agg %>%
mutate(new = agg_each$total)
names(yearly_agg)[k] <- as.character(i)
k <- k + 1
}
yearly_agg <-
yearly_agg %>%
gather(key = "year", value = "agg")
yearly_agg %>%
ggplot() +
geom_line(aes(x=as.numeric(year), y=as.numeric(agg)), color = "red", size = 1, show.legend=FALSE) +
geom_point(aes(x=as.numeric(year), y=as.numeric(agg)), color = "blue", show.legend=FALSE) +
scale_x_continuous(breaks = c(2008:2017)) +
labs(
title = "Aggregated number of hate crimes each year per 100k (2008-2017)",
x = "Year",
y = "Hate crimes per 100k"
) +
theme_bw() +
theme(
plot.margin = unit(c(2,2,2,1), "cm"),
plot.title = element_text(hjust = 0.4, face = "bold", size = 15),
text = element_text(size=13)
)
all_data %>%
mutate(qtile = factor(ntile(avr_hc, 5))) %>%
st_transform(4269) %>%
ggplot() +
geom_sf(aes(fill = qtile, color = qtile)) +
scale_color_brewer(palette = "OrRd", name = "Average Hate Crime Rates") +
scale_fill_brewer(palette = "OrRd", name = "Average Hate Crime Rates", na.value = "grey") +
labs(
title = "HATE CRIME RATES",
subtitle = "Average Hate Crimes Per 100k residents, 2017"
) +
annotate("text", x = 2009, y = 48.5, label = "No Data") +
theme_void() +
theme(
plot.margin = unit(c(1,1,1,1), "cm"),
plot.title = element_text(hjust = 0.5, face = "bold"),
plot.subtitle = element_text(hjust = 0.5)
)
all_data %>%
mutate(qtile = factor(ntile(avr_hc, 5))) %>%
st_transform(4269) %>%
ggplot() +
geom_sf(aes(fill = qtile, color = qtile)) +
scale_color_brewer(palette = "OrRd", name = "Average Hate Crime Rates") +
scale_fill_brewer(palette = "OrRd", name = "Average Hate Crime Rates", na.value = "grey") +
labs(
title = "HATE CRIME RATES",
subtitle = "Average Hate Crimes Per 100k residents, 2017"
) +
annotate("text", x = 2009, y = 48.5, label = "No Data") +
theme_void() +
theme(
plot.margin = unit(c(1,1,1,1), "cm"),
plot.title = element_text(hjust = 0.5, face = "bold"),
plot.subtitle = element_text(hjust = 0.5)
)
all_data %>%
mutate(qtile = factor(ntile(avr_hc, 5))) %>%
st_transform(4269) %>%
ggplot() +
geom_sf(aes(fill = qtile, color = qtile)) +
scale_color_brewer(palette = "OrRd", name = "Average Hate Crime Rates") +
scale_fill_brewer(palette = "OrRd", name = "Average Hate Crime Rates", na.value = "grey") +
labs(
title = "HATE CRIME RATES",
subtitle = "Average Hate Crimes Per 100k residents, 2017"
) +
theme_void() +
theme(
plot.margin = unit(c(1,1,1,1), "cm"),
plot.title = element_text(hjust = 0.5, face = "bold"),
plot.subtitle = element_text(hjust = 0.5)
)
knitr::opts_chunk$set(echo = TRUE)
library(stargazer)
library(tidyverse)
library(lubridate)
library(forcats)
library(jsonlite)
library(lwgeom)
library(tidycensus)
library(fredr)
library(readxl)
library(sf)
library(ggplot2)
library(plotly)
library(quantmod)
library(gapminder)
census_api_key("03ab2d6505a1b176b91412dad7ca0692866d7799")
census_vars <- load_variables(2016, "acs5")
hc_nums <- read_xls("2017.xls")
#divorced <- read_csv("divorced_rate.csv")
alcohol <- read_csv("alcohol_per_cpt.csv")
#inactive <- read_csv("phy_inactive_adults.csv")
#psn_bankruptcy <- read_csv("personal_bankruptcy_rate.csv")
#hl_security <- read_csv("homeland_security_grants19.csv")
#no_internet <- read_csv("household_without_itn17.csv")
#tequila <- read_csv("tequila_18.csv")
gvm_debts <- read_csv("gvm_debts_pc.csv")
firm_num <- read_csv("employer_firms16.csv")
bkr_fillings <- read_csv("bankruptcy_fillings.csv")
plot_data <- all_data %>%
arrange(-avr_hc) %>%
select(NAME,alcohol_pc,pct_nonctz,avr_hc) %>%
mutate(hc_level = fct_recode(
factor(ntile(avr_hc, 5)),
`>= 3.5` = "5",
`2.5 ~ 3.5` = "4",
`1.5 ~ 2.5` = "3",
`0.5 ~ 1.5` = "2",
`<= 0.5` = "1"
)) %>%
st_drop_geometry() %>%
na.omit()
plot_data %>%
ggplot(aes(x=pct_nonctz, y=alcohol_pc)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0.1)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
axis.title = element_text(colour = "salmon"),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
plot_data <- all_data %>%
arrange(-avr_hc) %>%
select(NAME,GINIidx,pct_nonctz,avr_hc) %>%
mutate(hc_level = fct_recode(
factor(ntile(avr_hc, 5)),
`>= 3.5` = "5",
`2.5 ~ 3.5` = "4",
`1.5 ~ 2.5` = "3",
`0.5 ~ 1.5` = "2",
`<= 0.5` = "1"
)) %>%
st_drop_geometry() %>%
na.omit()
plot_data %>%
ggplot(aes(x=pct_nonctz, y=GINIidx)) +
geom_point(aes(color = hc_level, size = hc_level), alpha = 0.6, show.legend = TRUE) +
scale_x_continuous(breaks = seq(0, 15, 5), expand = c(0.1, 0.1)) +
scale_y_continuous(breaks = seq(0.42, 0.54, 0.03), expand = c(0.1, 0)) +
scale_size_discrete(range = c(1,12), name = "Average hate crimes per 100k") +
scale_color_brewer(palette = "RdPu", name = "Average hate crimes per 100k") +
labs(
title = "Hate Crimes v.s. Non-citizen Rate & GINI Index",
x = "Percentage of Non-citizen",
y = "GINI index"
) +
theme_classic() +
theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(0.6, 0.6, 0.6, 0.6, "cm"),
text = element_text(size=13),
axis.title = element_text(colour = "salmon"),
plot.title = element_text(hjust = 0.35, color = "salmon", face = "bold", size = 18),
legend.justification=c(0,0),
legend.title = element_text(size=12, color = "salmon")
)
